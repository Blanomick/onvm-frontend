{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import'./Auth.css';// Configuration de l'URL du backend (local ou en ligne)\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';console.log(\"ðŸ”¹ API URL utilisÃ©e :\",API_URL);const Auth=_ref=>{let{onLogin}=_ref;const[isLogin,setIsLogin]=useState(true);const[username,setUsername]=useState('');const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[confirmPassword,setConfirmPassword]=useState('');const[error,setError]=useState('');const navigate=useNavigate();const handleSubmit=async e=>{e.preventDefault();setError('');// VÃ©rification des champs avant envoi\nif(!email.trim()||!password.trim()||!isLogin&&!username.trim()){setError('Tous les champs doivent Ãªtre remplis.');return;}if(!isLogin&&password!==confirmPassword){setError('Les mots de passe ne correspondent pas.');return;}const endpoint=isLogin?'/api/auth/login':'/api/auth/register';const url=`${API_URL}${endpoint}`;const data={email:email.trim(),password:password.trim(),...(isLogin?{}:{username:username.trim()})};console.log(\"ðŸ”¹ Type de requÃªte :\",isLogin?\"Connexion\":\"Inscription\");console.log(\"ðŸ”¹ URL utilisÃ©e :\",url);console.log(\"ðŸ”¹ DonnÃ©es envoyÃ©es :\",data);try{const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});const result=await response.json();console.log(\"ðŸ”¹ RÃ©ponse du serveur :\",result);if(!response.ok){setError(`Erreur : ${result.message||\"Une erreur est survenue.\"}`);console.error(\"ðŸ”´ Erreur API :\",result.message);return;}alert(result.message);if(result.user){console.log(\"âœ… Utilisateur connectÃ© :\",result.user);onLogin(result.user);// Redirection vers la page de publications aprÃ¨s connexion\nnavigate('/publication',{state:{username:result.user.username,profilePicture:result.user.profilePicture}});}}catch(error){console.error(\"ðŸ”´ Erreur rÃ©seau :\",error);setError(\"Impossible de contacter le serveur. VÃ©rifiez votre connexion.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"site-name\",children:\"ONVM\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-toggle\",children:[/*#__PURE__*/_jsx(\"span\",{onClick:()=>{setIsLogin(!isLogin);setError('');},children:isLogin?\"Connexion\":\"Inscription\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setIsLogin(!isLogin);setError('');},className:\"toggle-button\",children:/*#__PURE__*/_jsx(\"span\",{className:\"toggle-arrow\",children:\"\\u2192\"})})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"auth-form\",onSubmit:handleSubmit,children:[!isLogin&&/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nom d'utilisateur\",value:username,onChange:e=>setUsername(e.target.value),required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:email,onChange:e=>setEmail(e.target.value),required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Mot de passe\",value:password,onChange:e=>setPassword(e.target.value),required:true})}),!isLogin&&/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Confirmer le mot de passe\",value:confirmPassword,onChange:e=>setConfirmPassword(e.target.value),required:true})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:isLogin?\"Se connecter\":\"S'inscrire\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"switch-button\",onClick:()=>{setIsLogin(!isLogin);setError('');},children:isLogin?\"CrÃ©er un compte\":\"J'ai dÃ©jÃ  un compte\"})]});};export default Auth;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","console","log","Auth","_ref","onLogin","isLogin","setIsLogin","username","setUsername","email","setEmail","password","setPassword","confirmPassword","setConfirmPassword","error","setError","navigate","handleSubmit","e","preventDefault","trim","endpoint","url","data","response","fetch","method","headers","body","JSON","stringify","result","json","ok","message","alert","user","state","profilePicture","className","children","onClick","onSubmit","type","placeholder","value","onChange","target","required","style","color"],"sources":["C:/Users/mambo/Downloads/ONVM/frontend/src/components/Auth.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './Auth.css';\r\n\r\n// Configuration de l'URL du backend (local ou en ligne)\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\nconsole.log(\"ðŸ”¹ API URL utilisÃ©e :\", API_URL);\r\n\r\nconst Auth = ({ onLogin }) => {\r\n  const [isLogin, setIsLogin] = useState(true);\r\n  const [username, setUsername] = useState('');\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n\r\n    // VÃ©rification des champs avant envoi\r\n    if (!email.trim() || !password.trim() || (!isLogin && !username.trim())) {\r\n      setError('Tous les champs doivent Ãªtre remplis.');\r\n      return;\r\n    }\r\n\r\n    if (!isLogin && password !== confirmPassword) {\r\n      setError('Les mots de passe ne correspondent pas.');\r\n      return;\r\n    }\r\n\r\n    const endpoint = isLogin ? '/api/auth/login' : '/api/auth/register';\r\n    const url = `${API_URL}${endpoint}`;\r\n\r\n    const data = {\r\n      email: email.trim(),\r\n      password: password.trim(),\r\n      ...(isLogin ? {} : { username: username.trim() }),\r\n    };\r\n\r\n    console.log(\"ðŸ”¹ Type de requÃªte :\", isLogin ? \"Connexion\" : \"Inscription\");\r\n    console.log(\"ðŸ”¹ URL utilisÃ©e :\", url);\r\n    console.log(\"ðŸ”¹ DonnÃ©es envoyÃ©es :\", data);\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(data),\r\n      });\r\n\r\n      const result = await response.json();\r\n      console.log(\"ðŸ”¹ RÃ©ponse du serveur :\", result);\r\n\r\n      if (!response.ok) {\r\n        setError(`Erreur : ${result.message || \"Une erreur est survenue.\"}`);\r\n        console.error(\"ðŸ”´ Erreur API :\", result.message);\r\n        return;\r\n      }\r\n\r\n      alert(result.message);\r\n\r\n      if (result.user) {\r\n        console.log(\"âœ… Utilisateur connectÃ© :\", result.user);\r\n        onLogin(result.user);\r\n\r\n        // Redirection vers la page de publications aprÃ¨s connexion\r\n        navigate('/publication', {\r\n          state: {\r\n            username: result.user.username,\r\n            profilePicture: result.user.profilePicture,\r\n          },\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error(\"ðŸ”´ Erreur rÃ©seau :\", error);\r\n      setError(\"Impossible de contacter le serveur. VÃ©rifiez votre connexion.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-container\">\r\n      <div className=\"site-name\">ONVM</div>\r\n      <div className=\"auth-toggle\">\r\n        <span onClick={() => { setIsLogin(!isLogin); setError(''); }}>\r\n          {isLogin ? \"Connexion\" : \"Inscription\"}\r\n        </span>\r\n        <button onClick={() => { setIsLogin(!isLogin); setError(''); }} className=\"toggle-button\">\r\n          <span className=\"toggle-arrow\">â†’</span>\r\n        </button>\r\n      </div>\r\n\r\n      <form className=\"auth-form\" onSubmit={handleSubmit}>\r\n        {!isLogin && (\r\n          <div className=\"input-container\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Nom d'utilisateur\"\r\n              value={username}\r\n              onChange={(e) => setUsername(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n        )}\r\n        <div className=\"input-container\">\r\n          <input\r\n            type=\"email\"\r\n            placeholder=\"Email\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        <div className=\"input-container\">\r\n          <input\r\n            type=\"password\"\r\n            placeholder=\"Mot de passe\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            required\r\n          />\r\n        </div>\r\n        {!isLogin && (\r\n          <div className=\"input-container\">\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Confirmer le mot de passe\"\r\n              value={confirmPassword}\r\n              onChange={(e) => setConfirmPassword(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        <button type=\"submit\" className=\"submit-button\">\r\n          {isLogin ? \"Se connecter\" : \"S'inscrire\"}\r\n        </button>\r\n      </form>\r\n\r\n      {error && <p style={{ color: 'red' }}>{error}</p>}\r\n\r\n      <button className=\"switch-button\" onClick={() => { setIsLogin(!isLogin); setError(''); }}>\r\n        {isLogin ? \"CrÃ©er un compte\" : \"J'ai dÃ©jÃ  un compte\"}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}